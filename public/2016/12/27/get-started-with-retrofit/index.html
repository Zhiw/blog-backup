<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>【译】网络请求框架 Retrofit 2 使用入门 | Zhiw</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="Zhiw , Android , Hexo, 安卓开发 , Java , Android Studio" />
  

  <meta name="description" content="原文地址：Get Started With Retrofit 2 HTTP Client
原文作者：Chike Mgbemena
译文出自：掘金翻译计划
译者：Zhiw
校对者：PhxNirvana，Draftbk


网络请求框架 Retrofit 2 使用入门
你将要创造什么
Retrofit 是什么？Retrofit 是一个用于 Android 和 Java 平台的类型安全的网络请求框架。R">
<meta property="og:type" content="article">
<meta property="og:title" content="【译】网络请求框架 Retrofit 2 使用入门">
<meta property="og:url" content="http://yuzhiw.com/2016/12/27/get-started-with-retrofit/index.html">
<meta property="og:site_name" content="Zhiw">
<meta property="og:description" content="原文地址：Get Started With Retrofit 2 HTTP Client
原文作者：Chike Mgbemena
译文出自：掘金翻译计划
译者：Zhiw
校对者：PhxNirvana，Draftbk


网络请求框架 Retrofit 2 使用入门
你将要创造什么
Retrofit 是什么？Retrofit 是一个用于 Android 和 Java 平台的类型安全的网络请求框架。R">
<meta property="og:image" content="https://cms-assets.tutsplus.com/uploads/users/1499/posts/27792/final_image/gt5.JPG">
<meta property="og:image" content="https://cms-assets.tutsplus.com/uploads/users/1499/posts/27792/image/a2.png">
<meta property="og:image" content="https://cms-assets.tutsplus.com/uploads/users/769/posts/27792/image/1.jpg">
<meta property="og:image" content="https://cms-assets.tutsplus.com/uploads/users/1499/posts/27792/image/u99.jpg">
<meta property="og:image" content="https://cms-assets.tutsplus.com/uploads/users/769/posts/27792/image/kpo09.jpg">
<meta property="og:image" content="https://cms-assets.tutsplus.com/uploads/users/1499/posts/27792/image/gt5.JPG">
<meta property="og:updated_time" content="2017-01-18T07:56:42.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【译】网络请求框架 Retrofit 2 使用入门">
<meta name="twitter:description" content="原文地址：Get Started With Retrofit 2 HTTP Client
原文作者：Chike Mgbemena
译文出自：掘金翻译计划
译者：Zhiw
校对者：PhxNirvana，Draftbk


网络请求框架 Retrofit 2 使用入门
你将要创造什么
Retrofit 是什么？Retrofit 是一个用于 Android 和 Java 平台的类型安全的网络请求框架。R">

  

  
    <link rel="icon" href="/images/favicon.ico">
  

  <link href="/css/styles.css?v=d671a41f" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css" type="text/css">
  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-77757943-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?288b0ec4a4935e5a70a2a1e7475509e9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">Zhiw</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">Zhiw</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">Posts List</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#网络请求框架-Retrofit-2-使用入门"><span class="toc-text">网络请求框架 Retrofit 2 使用入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Retrofit-是什么？"><span class="toc-text">Retrofit 是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#那么我们为什么要用-Retrofit-呢？"><span class="toc-text">那么我们为什么要用 Retrofit 呢？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-创建一个-Android-Studio-工程"><span class="toc-text">1.创建一个 Android Studio 工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-添加依赖"><span class="toc-text">2. 添加依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-添加网络权限"><span class="toc-text">3. 添加网络权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-自动生成-Java-对象"><span class="toc-text">4.自动生成 Java 对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#取得示例的-JSON-数据"><span class="toc-text">取得示例的 JSON 数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#将-JSON-数据映射到-Java-对象"><span class="toc-text">将 JSON 数据映射到 Java 对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#将数据模型导入-Android-Studio"><span class="toc-text">将数据模型导入 Android Studio</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-创建-Retrofit-实例"><span class="toc-text">5. 创建 Retrofit 实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-创建-API-接口"><span class="toc-text">6.创建 API 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-创建-API-工具类"><span class="toc-text">7.创建 API 工具类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-显示到-RecyclerView"><span class="toc-text">8.显示到 RecyclerView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-执行请求"><span class="toc-text">9.执行请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-理解-enqueue"><span class="toc-text">10. 理解 enqueue()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-测试应用"><span class="toc-text">11.测试应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-结合-RxJava"><span class="toc-text">12. 结合 RxJava</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#第一步"><span class="toc-text">第一步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第二步"><span class="toc-text">第二步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第三步"><span class="toc-text">第三步</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-get-started-with-retrofit" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">【译】网络请求框架 Retrofit 2 使用入门</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2016.12.27</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>Yu Zhiwei</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      

      
        <i class="icon-comment"></i> 
        <span class="ds-thread-count" data-thread-key="post-get-started-with-retrofit"><i class="fa fa-spinner fa-spin"></i></span> 条评论
      
      
    </div>
  </header>

  <div class="article-content">
    
      <blockquote>
<ul>
<li>原文地址：<a href="https://code.tutsplus.com/tutorials/getting-started-with-retrofit-2--cms-27792" target="_blank" rel="external">Get Started With Retrofit 2 HTTP Client</a></li>
<li>原文作者：<a href="https://tutsplus.com/authors/chike-mgbemena" target="_blank" rel="external">Chike Mgbemena</a></li>
<li>译文出自：<a href="https://github.com/xitu/gold-miner" target="_blank" rel="external">掘金翻译计划</a></li>
<li>译者：<a href="https://github.com/Zhiw" target="_blank" rel="external">Zhiw</a></li>
<li>校对者：<a href="https://github.com/phxnirvana" target="_blank" rel="external">PhxNirvana</a>，<a href="https://github.com/draftbk" target="_blank" rel="external">Draftbk</a></li>
</ul>
</blockquote>
<h1 id="网络请求框架-Retrofit-2-使用入门"><a href="#网络请求框架-Retrofit-2-使用入门" class="headerlink" title="网络请求框架 Retrofit 2 使用入门"></a>网络请求框架 Retrofit 2 使用入门</h1><p><img src="https://cms-assets.tutsplus.com/uploads/users/1499/posts/27792/final_image/gt5.JPG" alt="Final product image"></p>
<p>你将要创造什么</p>
<h2 id="Retrofit-是什么？"><a href="#Retrofit-是什么？" class="headerlink" title="Retrofit 是什么？"></a>Retrofit 是什么？</h2><p><a href="https://square.github.io/retrofit/" target="_blank" rel="external">Retrofit</a> 是一个用于 Android 和 Java 平台的类型安全的网络请求框架。Retrofit 通过将 API 抽象成 Java 接口而让我们连接到 REST web 服务变得很轻松。在这个教程里，我会向你介绍如何使用这个 Android 上最受欢迎和经常推荐的网络请求库之一。</p>
<p>这个强大的库可以很简单的把返回的 JSON 或者 XML 数据解析成简单 Java 对象（POJO）。<code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, 和 <code>DELETE</code> 这些请求都可以执行。</p>
<p>和大多数开源软件一样，Retrofit 也是建立在一些强大的库和工具基础上的。Retrofit 背后用了同一个开发团队的 <a href="http://square.github.io/okhttp/" target="_blank" rel="external">OkHttp</a> 来处理网络请求。而且 Retrofit 不再内置 JSON 转换器来将 JSON 装换为 Java 对象。取而代之的是提供以下 JSON 转换器来处理：</p>
<ul>
<li>Gson: <code>com.squareup.retrofit:converter-gson</code></li>
<li>Jackson: <code>com.squareup.retrofit:converter-jackson</code></li>
<li>Moshi: <code>com.squareup.retrofit:converter-moshi</code></li>
</ul>
<p>对于 <a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="external">Protocol Buffers</a>, Retrofit 提供了:</p>
<ul>
<li><p>Protobuf:  <code>com.squareup.retrofit2:converter-protobuf</code></p>
</li>
<li><p>Wire:  <code>com.squareup.retrofit2:converter-wire</code></p>
</li>
</ul>
<p>对于 XML 解析, Retrofit 提供了:</p>
<ul>
<li>Simple Framework:  <code>com.squareup.retrofit2:converter-simpleframework</code></li>
</ul>
<h2 id="那么我们为什么要用-Retrofit-呢？"><a href="#那么我们为什么要用-Retrofit-呢？" class="headerlink" title="那么我们为什么要用 Retrofit 呢？"></a>那么我们为什么要用 Retrofit 呢？</h2><p>开发一个自己的用于请求 REST API 的类型安全的网络请求库是一件很痛苦的事情：你需要处理很多功能，比如建立连接，处理缓存，重连接失败请求，线程，响应数据的解析，错误处理等等。从另一方面来说，Retrofit 是一个有优秀的计划，文档和测试并且经过考验的库，它会帮你节省你的宝贵时间以及不让你那么头痛。</p>
<p>在这个教程里，我会构建一个简单的应用，根据 <a href="https://api.stackexchange.com/docs" target="_blank" rel="external">Stack Exchange</a> API 查询上面最近的回答，从而来教你如何使用 Retrofit 2 来处理网络请求。我们会指明 <code>/answers</code> 这样一个路径，然后拼接到 base URL <a href="https://api.stackexchange.com/2.2" target="_blank" rel="external">https://api.stackexchange.com/2.2</a>/ 上执行一个 <code>GET</code> 请求——然后我们会得到响应结果并且显示到 RecyclerView 上。我还会向你展示如何利用 RxJava 来轻松地管理状态和数据流。</p>
<h2 id="1-创建一个-Android-Studio-工程"><a href="#1-创建一个-Android-Studio-工程" class="headerlink" title="1.创建一个 Android Studio 工程"></a>1.创建一个 Android Studio 工程</h2><p>打开 Android Studio，创建一个新工程，然后创建一个命名为 <code>MainActivity</code> 的空白 Activity。<br><img src="https://cms-assets.tutsplus.com/uploads/users/1499/posts/27792/image/a2.png" alt="Create a new empty activity"></p>
<h2 id="2-添加依赖"><a href="#2-添加依赖" class="headerlink" title="2. 添加依赖"></a>2. 添加依赖</h2><p>创建一个新的工程后，在你的 <code>build.gradle</code> 文件里面添加以下依赖。这些依赖包括 RecyclerView，Retrofit 库，还有 Google 出品的将 JSON 装换为 POJO（简单 Java 对象）的 Gson 库，以及 Retrofit 的 Gson。</p>
<pre><code>// Retrofit
compile &apos;com.squareup.retrofit2:retrofit:2.1.0&apos;

// JSON Parsing
compile &apos;com.google.code.gson:gson:2.6.1&apos;
compile &apos;com.squareup.retrofit2:converter-gson:2.1.0&apos;

// recyclerview
compile &apos;com.android.support:recyclerview-v7:25.0.1&apos;
</code></pre><p>不要忘记同步（sync）工程来下载这些库。</p>
<h2 id="3-添加网络权限"><a href="#3-添加网络权限" class="headerlink" title="3. 添加网络权限"></a>3. 添加网络权限</h2><p>要执行网络操作，我们需要在应用的清单文件 <strong>AndroidManifest.xml</strong> 里面声明网络权限。<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">manifest</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">          <span class="attribute">package</span>=<span class="value">"com.chikeandroid.retrofittutorial"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">uses-permission</span> <span class="attribute">android:name</span>=<span class="value">"android.permission.INTERNET"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">application</span></span><br><span class="line">            <span class="attribute">android:allowBackup</span>=<span class="value">"true"</span></span><br><span class="line">            <span class="attribute">android:icon</span>=<span class="value">"@mipmap/ic_launcher"</span></span><br><span class="line">            <span class="attribute">android:label</span>=<span class="value">"@string/app_name"</span></span><br><span class="line">            <span class="attribute">android:supportsRtl</span>=<span class="value">"true"</span></span><br><span class="line">            <span class="attribute">android:theme</span>=<span class="value">"@style/AppTheme"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">activity</span> <span class="attribute">android:name</span>=<span class="value">".MainActivity"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">action</span> <span class="attribute">android:name</span>=<span class="value">"android.intent.action.MAIN"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="title">category</span> <span class="attribute">android:name</span>=<span class="value">"android.intent.category.LAUNCHER"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="4-自动生成-Java-对象"><a href="#4-自动生成-Java-对象" class="headerlink" title="4.自动生成 Java 对象"></a>4.自动生成 Java 对象</h2><p>我们利用一个非常有用的工具来帮我们将返回的 JSON 数据自动生成 Java 对象：<a href="http://www.jsonschema2pojo.org/" target="_blank" rel="external">jsonschema2pojo</a>。</p>
<h3 id="取得示例的-JSON-数据"><a href="#取得示例的-JSON-数据" class="headerlink" title="取得示例的 JSON 数据"></a>取得示例的 JSON 数据</h3><p>复制粘贴 <a href="https://api.stackexchange.com/2.2/answers?order=desc&amp;sort=activity&amp;site=stackoverflow" target="_blank" rel="external">https://api.stackexchange.com/2.2/answers?order=desc&amp;sort=activity&amp;site=stackoverflow</a> 到你的浏览器地址栏，或者如果你熟悉的话，你可以使用 <a href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?hl=en" target="_blank" rel="external">Postman</a> 这个工具。然后点击 <strong>Enter</strong> —— 它将会根据那个地址执行一个 GET 请求，你会看到返回的是一个 JSON 对象数组，下面的截图是使用了 Postman 的 JSON 响应结果。</p>
<p><img src="https://cms-assets.tutsplus.com/uploads/users/769/posts/27792/image/1.jpg" alt="API response to GET request"></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   "<span class="attribute">items</span>": <span class="value">[</span><br><span class="line">     &#123;</span><br><span class="line">       "<span class="attribute">owner</span>": <span class="value">&#123;</span><br><span class="line">         "<span class="attribute">reputation</span>": <span class="value"><span class="number">1</span></span>,</span><br><span class="line">         "<span class="attribute">user_id</span>": <span class="value"><span class="number">6540831</span></span>,</span><br><span class="line">         "<span class="attribute">user_type</span>": <span class="value"><span class="string">"registered"</span></span>,</span><br><span class="line">         "<span class="attribute">profile_image</span>": <span class="value"><span class="string">"https://www.gravatar.com/avatar/6a468ce8a8ff42c17923a6009ab77723?s=128&amp;d=identicon&amp;r=PG&amp;f=1"</span></span>,</span><br><span class="line">         "<span class="attribute">display_name</span>": <span class="value"><span class="string">"bobolafrite"</span></span>,</span><br><span class="line">         "<span class="attribute">link</span>": <span class="value"><span class="string">"http://stackoverflow.com/users/6540831/bobolafrite"</span></span><br><span class="line">       </span>&#125;</span>,</span><br><span class="line">       "<span class="attribute">is_accepted</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">       "<span class="attribute">score</span>": <span class="value"><span class="number">0</span></span>,</span><br><span class="line">       "<span class="attribute">last_activity_date</span>": <span class="value"><span class="number">1480862271</span></span>,</span><br><span class="line">       "<span class="attribute">creation_date</span>": <span class="value"><span class="number">1480862271</span></span>,</span><br><span class="line">       "<span class="attribute">answer_id</span>": <span class="value"><span class="number">40959732</span></span>,</span><br><span class="line">       "<span class="attribute">question_id</span>": <span class="value"><span class="number">35931342</span></span><br><span class="line">     </span>&#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       "<span class="attribute">owner</span>": <span class="value">&#123;</span><br><span class="line">         "<span class="attribute">reputation</span>": <span class="value"><span class="number">629</span></span>,</span><br><span class="line">         "<span class="attribute">user_id</span>": <span class="value"><span class="number">3054722</span></span>,</span><br><span class="line">         "<span class="attribute">user_type</span>": <span class="value"><span class="string">"registered"</span></span>,</span><br><span class="line">         "<span class="attribute">profile_image</span>": <span class="value"><span class="string">"https://www.gravatar.com/avatar/0cf65651ae9a3ba2858ef0d0a7dbf900?s=128&amp;d=identicon&amp;r=PG&amp;f=1"</span></span>,</span><br><span class="line">         "<span class="attribute">display_name</span>": <span class="value"><span class="string">"jeremy-denis"</span></span>,</span><br><span class="line">         "<span class="attribute">link</span>": <span class="value"><span class="string">"http://stackoverflow.com/users/3054722/jeremy-denis"</span></span><br><span class="line">       </span>&#125;</span>,</span><br><span class="line">       "<span class="attribute">is_accepted</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">       "<span class="attribute">score</span>": <span class="value"><span class="number">0</span></span>,</span><br><span class="line">       "<span class="attribute">last_activity_date</span>": <span class="value"><span class="number">1480862260</span></span>,</span><br><span class="line">       "<span class="attribute">creation_date</span>": <span class="value"><span class="number">1480862260</span></span>,</span><br><span class="line">       "<span class="attribute">answer_id</span>": <span class="value"><span class="number">40959731</span></span>,</span><br><span class="line">       "<span class="attribute">question_id</span>": <span class="value"><span class="number">40959661</span></span><br><span class="line">     </span>&#125;,</span><br><span class="line">     ...</span><br><span class="line">   ]</span>,</span><br><span class="line">   "<span class="attribute">has_more</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">   "<span class="attribute">backoff</span>": <span class="value"><span class="number">10</span></span>,</span><br><span class="line">   "<span class="attribute">quota_max</span>": <span class="value"><span class="number">300</span></span>,</span><br><span class="line">   "<span class="attribute">quota_remaining</span>": <span class="value"><span class="number">241</span></span><br><span class="line"> </span>&#125;</span><br></pre></td></tr></table></figure>
<p>从你的浏览器或者 Postman 复制 JSON 响应结果。</p>
<h3 id="将-JSON-数据映射到-Java-对象"><a href="#将-JSON-数据映射到-Java-对象" class="headerlink" title="将 JSON 数据映射到 Java 对象"></a>将 JSON 数据映射到 Java 对象</h3><p>现在访问 <a href="http://www.jsonschema2pojo.org/" target="_blank" rel="external">jsonschema2pojo</a>，然后粘贴 JSON 响应结果到输入框。</p>
<p>选择 Source Type 为 <strong>JSON</strong>，Annotation Style 为 <strong>Gson</strong>，然后取消勾选 <strong>Allow additional properties</strong>。</p>
<p><img src="https://cms-assets.tutsplus.com/uploads/users/1499/posts/27792/image/u99.jpg" alt=""></p>
<p>然后点击 <strong>Preview</strong> 按钮来生成 Java 对象。</p>
<p><img src="https://cms-assets.tutsplus.com/uploads/users/769/posts/27792/image/kpo09.jpg" alt=""></p>
<p>你可能想知道在生成的代码里面， <code>@SerializedName</code> 和 <code>@Expose</code> 是干什么的。别着急，我会一一解释的。</p>
<p>Gson 使用 <code>@SerializedName</code> 注解来将 JSON 的 key 映射到我们类的变量。为了与 Java 对类成员属性的驼峰命名方法保持一致，不建议在变量中使用下划线将单词分开。<code>@SerializeName</code> 就是两者的翻译官。</p>
<pre><code>@SerializedName(&quot;quota_remaining&quot;)
@Expose
private Integer quotaRemaining;
</code></pre><p>在上面的示例中，我们告诉 Gson 我们的 JSON 的 key <code>quota_remaining</code> 应该被映射到 Java 变量 <code>quotaRemaining</code>上。如果两个值是一样的，即如果我们的 JSON 的 key 和 Java 变量一样是 <code>quotaRemaining</code>，那么就没有必要为变量设置 <code>@SerializedName</code> 注解，Gson 会自己搞定。</p>
<p><code>@Expose</code> 注解表明在 JSON 序列化或反序列化的时候，该成员应该暴露给 Gson。</p>
<h3 id="将数据模型导入-Android-Studio"><a href="#将数据模型导入-Android-Studio" class="headerlink" title="将数据模型导入 Android Studio"></a>将数据模型导入 Android Studio</h3><p>现在让我们回到 Android Studio。新建一个 <strong>data</strong> 的子包，在 data 里面再新建一个 <strong>model</strong> 的包。在 model 包里面，新建一个 Owner 的 Java 类。<br>然后将 jsonschema2pojo 生成的 <code>Owner</code> 类复制粘贴到刚才新建的 <code>Owner</code> 类文件里面。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.gson.annotations.Expose;</span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Owner</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"reputation"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer reputation;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"user_id"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"user_type"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> String userType;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"profile_image"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> String profileImage;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"display_name"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> String displayName;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"link"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> String link;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"accept_rate"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer acceptRate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getReputation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> reputation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReputation</span><span class="params">(Integer reputation)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.reputation = reputation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getUserId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserId</span><span class="params">(Integer userId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserType</span><span class="params">(String userType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userType = userType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getProfileImage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> profileImage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProfileImage</span><span class="params">(String profileImage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.profileImage = profileImage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDisplayName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> displayName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDisplayName</span><span class="params">(String displayName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.displayName = displayName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getLink</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> link;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLink</span><span class="params">(String link)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.link = link;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAcceptRate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> acceptRate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAcceptRate</span><span class="params">(Integer acceptRate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.acceptRate = acceptRate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>利用同样的方法从 jsonschema2pojo 复制过来，新建一个 <code>Item</code> 类。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.gson.annotations.Expose;</span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"owner"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Owner owner;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"is_accepted"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Boolean isAccepted;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"score"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer score;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"last_activity_date"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer lastActivityDate;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"creation_date"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer creationDate;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"answer_id"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer answerId;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"question_id"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer questionId;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"last_edit_date"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer lastEditDate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Owner <span class="title">getOwner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> owner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOwner</span><span class="params">(Owner owner)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.owner = owner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">getIsAccepted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isAccepted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIsAccepted</span><span class="params">(Boolean isAccepted)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isAccepted = isAccepted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getScore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> score;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setScore</span><span class="params">(Integer score)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.score = score;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getLastActivityDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lastActivityDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastActivityDate</span><span class="params">(Integer lastActivityDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lastActivityDate = lastActivityDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getCreationDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> creationDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCreationDate</span><span class="params">(Integer creationDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.creationDate = creationDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAnswerId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> answerId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAnswerId</span><span class="params">(Integer answerId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.answerId = answerId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getQuestionId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> questionId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuestionId</span><span class="params">(Integer questionId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.questionId = questionId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getLastEditDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lastEditDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastEditDate</span><span class="params">(Integer lastEditDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lastEditDate = lastEditDate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后，为返回的 StackOverflow 回答新建一个 <code>SOAnswersResponse</code> 类。注意在 jsonschema2pojo 里面类名是 <code>Example</code>，别忘记把类名改成 <code>SOAnswersResponse</code>。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.gson.annotations.Expose;</span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SOAnswersResponse</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"items"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Item&gt; items = <span class="keyword">null</span>;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"has_more"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Boolean hasMore;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"backoff"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer backoff;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"quota_max"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer quotaMax;</span><br><span class="line">    <span class="annotation">@SerializedName</span>(<span class="string">"quota_remaining"</span>)</span><br><span class="line">    <span class="annotation">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer quotaRemaining;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Item&gt; <span class="title">getItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> items;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setItems</span><span class="params">(List&lt;Item&gt; items)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items = items;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">getHasMore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hasMore;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHasMore</span><span class="params">(Boolean hasMore)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hasMore = hasMore;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getBackoff</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> backoff;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBackoff</span><span class="params">(Integer backoff)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.backoff = backoff;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getQuotaMax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> quotaMax;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuotaMax</span><span class="params">(Integer quotaMax)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.quotaMax = quotaMax;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getQuotaRemaining</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> quotaRemaining;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuotaRemaining</span><span class="params">(Integer quotaRemaining)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.quotaRemaining = quotaRemaining;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-创建-Retrofit-实例"><a href="#5-创建-Retrofit-实例" class="headerlink" title="5. 创建 Retrofit 实例"></a>5. 创建 Retrofit 实例</h2><p>为了使用 Retrofit 向 REST API 发送一个网络请求，我们需要用 <a href="http://square.github.io/retrofit/2.x/retrofit/retrofit2/Retrofit.Builder.html" target="_blank" rel="external"><code>Retrofit.Builder</code></a> 类来创建一个实例，并且配置一个 base URL。</p>
<p>在 <code>data</code> 包里面新建一个 <code>remote</code> 的包，然后在 <code>remote</code> 包里面新建一个 <code>RetrofitClient</code> 类。这个类会创建一个 Retrofit 的单例。Retrofit 需要一个 base URL 来创建实例。所以我们在调用 <code>RetrofitClient.getClient(String baseUrl)</code> 时会传入一个 URL 参数。参见 13 行，这个 URL 用于构建 Retrofit 的实例。参见 14 行，我们也需要指明一个我们需要的 JSON converter（Gson）。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> retrofit2.Retrofit;</span><br><span class="line"><span class="keyword">import</span> retrofit2.converter.gson.GsonConverterFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RetrofitClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Retrofit retrofit = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Retrofit <span class="title">getClient</span><span class="params">(String baseUrl)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (retrofit==<span class="keyword">null</span>) &#123;</span><br><span class="line">            retrofit = <span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">                    .baseUrl(baseUrl)</span><br><span class="line">                    .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">                    .build();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> retrofit;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-创建-API-接口"><a href="#6-创建-API-接口" class="headerlink" title="6.创建 API 接口"></a>6.创建 API 接口</h2><p>在 remote 包里面，创建一个 <code>SOService</code> 接口，这个接口包含了我们将会用到用于执行网络请求的方法，比如 <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, 以及 <code>DELETE</code>。在该教程里面，我们将执行一个 <code>GET</code> 请求。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.chikeandroid.retrofittutorial.data.model.SOAnswersResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> retrofit2.Call;</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.GET;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SOService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="annotation">@GET</span>(<span class="string">"/answers?order=desc&amp;sort=activity&amp;site=stackoverflow"</span>)</span><br><span class="line">   Call&lt;List&lt;SOAnswersResponse&gt;&gt; getAnswers();</span><br><span class="line"></span><br><span class="line">   <span class="annotation">@GET</span>(<span class="string">"/answers?order=desc&amp;sort=activity&amp;site=stackoverflow"</span>)</span><br><span class="line">   Call&lt;List&lt;SOAnswersResponse&gt;&gt; getAnswers(<span class="annotation">@Query</span>(<span class="string">"tagged"</span>) String tags);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>GET</code> 注解明确的定义了当该方法调用的时候会执行一个 <code>GET</code> 请求。接口里每一个方法都必须有一个 HTTP 注解，用于提供请求方法和相对的 <code>URL</code>。Retrofit 内置了 5 种注解：<code>@GET</code>, <code>@POST</code>, <code>@PUT</code>, <code>@DELETE</code>, 和 <code>@HEAD</code>。</p>
<p>在第二个方法定义中，我们添加一个 query 参数用于从服务端过滤数据。Retrofit 提供了 <code>@Query(&quot;key&quot;)</code> 注解，这样就不用在地址里面直接写了。key 的值代表了 URL 里参数的名字。Retrofit 会把他们添加到 URL 里面。比如说，如果我们把 <code>android</code> 作为参数传递给 <code>getAnswers(String tags)</code> 方法，完整的 URL 将会是：</p>
<pre><code>https://api.stackexchange.com/2.2/answers?order=desc&amp;sort=activity&amp;site=stackoverflow&amp;tagged=android
</code></pre><p>接口方法的参数有以下注解：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>@Path</td>
<td>替换 API 地址中的变量</td>
</tr>
<tr>
<td>@Query</td>
<td>通过注解的名字指明 query 参数的名字</td>
</tr>
<tr>
<td>@Body</td>
<td>POST 请求的请求体</td>
</tr>
<tr>
<td>@Header</td>
<td>通过注解的参数值指明 header</td>
</tr>
</tbody>
</table>
<h2 id="7-创建-API-工具类"><a href="#7-创建-API-工具类" class="headerlink" title="7.创建 API 工具类"></a>7.创建 API 工具类</h2><p>现在我们要新建一个工具类。我们命名为 <code>ApiUtils</code>。该类设置了一个 base URL 常量，并且通过静态方法 <code>getSOService()</code> 为应用提供 <code>SOService</code> 接口。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BASE_URL = <span class="string">"https://api.stackexchange.com/2.2/"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SOService <span class="title">getSOService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RetrofitClient.getClient(BASE_URL).create(SOService.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="8-显示到-RecyclerView"><a href="#8-显示到-RecyclerView" class="headerlink" title="8.显示到 RecyclerView"></a>8.显示到 RecyclerView</h2><p>既然结果要显示到 <a href="https://code.tutsplus.com/tutorials/getting-started-with-recyclerview-and-cardview-on-android--cms-23465" target="_blank" rel="external">RecyclerView</a> 上面，我们需要一个 adpter。以下是 <code>AnswersAdapter</code> 类的代码片段。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnswersAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">AnswersAdapter</span>.<span class="title">ViewHolder</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Item&gt; mItems;</span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line">    <span class="keyword">private</span> PostItemListener mItemListener;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> TextView titleTv;</span><br><span class="line">        PostItemListener mItemListener;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ViewHolder</span><span class="params">(View itemView, PostItemListener postItemListener)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(itemView);</span><br><span class="line">            titleTv = (TextView) itemView.findViewById(android.R.id.text1);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.mItemListener = postItemListener;</span><br><span class="line">            itemView.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Item item = getItem(getAdapterPosition());</span><br><span class="line">            <span class="keyword">this</span>.mItemListener.onPostClick(item.getAnswerId());</span><br><span class="line"></span><br><span class="line">            notifyDataSetChanged();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AnswersAdapter</span><span class="params">(Context context, List&lt;Item&gt; posts, PostItemListener itemListener)</span> </span>&#123;</span><br><span class="line">        mItems = posts;</span><br><span class="line">        mContext = context;</span><br><span class="line">        mItemListener = itemListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AnswersAdapter.<span class="function">ViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Context context = parent.getContext();</span><br><span class="line">        LayoutInflater inflater = LayoutInflater.from(context);</span><br><span class="line"></span><br><span class="line">        View postView = inflater.inflate(android.R.layout.simple_list_item_1, parent, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        ViewHolder viewHolder = <span class="keyword">new</span> ViewHolder(postView, <span class="keyword">this</span>.mItemListener);</span><br><span class="line">        <span class="keyword">return</span> viewHolder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(AnswersAdapter.ViewHolder holder, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Item item = mItems.get(position);</span><br><span class="line">        TextView textView = holder.titleTv;</span><br><span class="line">        textView.setText(item.getOwner().getDisplayName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mItems.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateAnswers</span><span class="params">(List&lt;Item&gt; items)</span> </span>&#123;</span><br><span class="line">        mItems = items;</span><br><span class="line">        notifyDataSetChanged();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Item <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> adapterPosition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mItems.get(adapterPosition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PostItemListener</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onPostClick</span><span class="params">(<span class="keyword">long</span> id)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="9-执行请求"><a href="#9-执行请求" class="headerlink" title="9.执行请求"></a>9.执行请求</h2><p>在 <code>MainActivity</code> 的 <code>onCreate()</code> 方法内部，我们初始化 <code>SOService</code> 的实例（参见第 9 行），RecyclerView 以及 adapter。最后我们调用 <code>loadAnswers()</code> 方法。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> AnswersAdapter mAdapter;</span><br><span class="line">   <span class="keyword">private</span> RecyclerView mRecyclerView;</span><br><span class="line">   <span class="keyword">private</span> SOService mService;</span><br><span class="line"></span><br><span class="line">   <span class="annotation">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span> <span class="params">(Bundle savedInstanceState)</span>  </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.onCreate( savedInstanceState );</span><br><span class="line">       setContentView(R.layout.activity_main );</span><br><span class="line">       mService = ApiUtils.getSOService();</span><br><span class="line">       mRecyclerView = (RecyclerView) findViewById(R.id.rv_answers);</span><br><span class="line">       mAdapter = <span class="keyword">new</span> AnswersAdapter(<span class="keyword">this</span>, <span class="keyword">new</span> ArrayList&lt;Item&gt;(<span class="number">0</span>), <span class="keyword">new</span> AnswersAdapter.PostItemListener() &#123;</span><br><span class="line"></span><br><span class="line">           <span class="annotation">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPostClick</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">               Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"Post id is"</span> + id, Toast.LENGTH_SHORT).show();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line"></span><br><span class="line">       RecyclerView.LayoutManager layoutManager = <span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>);</span><br><span class="line">       mRecyclerView.setLayoutManager(layoutManager);</span><br><span class="line">       mRecyclerView.setAdapter(mAdapter);</span><br><span class="line">       mRecyclerView.setHasFixedSize(<span class="keyword">true</span>);</span><br><span class="line">       RecyclerView.ItemDecoration itemDecoration = <span class="keyword">new</span> DividerItemDecoration(<span class="keyword">this</span>, DividerItemDecoration.VERTICAL_LIST);</span><br><span class="line">       mRecyclerView.addItemDecoration(itemDecoration);</span><br><span class="line"></span><br><span class="line">       loadAnswers();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p><code>loadAnswers()</code> 方法通过调用 <code>enqueue()</code> 方法来进行网络请求。当响应结果返回的时候，Retrofit 会帮我们把 JSON 数据解析成一个包含 Java 对象的 list（这是通过 <code>GsonConverter</code> 实现的）。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadAnswers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mService.getAnswers().enqueue(<span class="keyword">new</span> Callback&lt;SOAnswersResponse&gt;() &#123;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(Call&lt;SOAnswersResponse&gt; call, Response&lt;SOAnswersResponse&gt; response)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(response.isSuccessful()) &#123;</span><br><span class="line">            mAdapter.updateAnswers(response.body().getItems());</span><br><span class="line">            Log.d(<span class="string">"MainActivity"</span>, <span class="string">"posts loaded from API"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> statusCode  = response.code();</span><br><span class="line">            <span class="comment">// handle request errors depending on status code</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Call&lt;SOAnswersResponse&gt; call, Throwable t)</span> </span>&#123;</span><br><span class="line">       showErrorMessage();</span><br><span class="line">        Log.d(<span class="string">"MainActivity"</span>, <span class="string">"error loading from API"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="10-理解-enqueue"><a href="#10-理解-enqueue" class="headerlink" title="10. 理解 enqueue()"></a>10. 理解 <code>enqueue()</code></h2><p><code>enqueue()</code> 会发送一个异步请求，当响应结果返回的时候通过回调通知应用。因为是异步请求，所以 Retrofit 将在后台线程处理，这样就不会让 UI 主线程堵塞或者受到影响。</p>
<p>要使用 <code>enqueue()</code>，你必须实现这两个回调方法：</p>
<ul>
<li><code>onResponse()</code></li>
<li><code>onFailure()</code></li>
</ul>
<p>只有在请求有响应结果的时候才会调用其中一个方法。</p>
<ul>
<li><code>onResponse()</code>：接收到 HTTP 响应时调用。该方法会在响应结果能够被正确地处理的时候调用，即使服务器返回了一个错误信息。所以如果你收到了一个 404 或者 500 的状态码，这个方法还是会调用。为了拿到状态码以便后续的处理，你可以使用 <code>response.code()</code> 方法。你也可以使用 <code>isSuccessful()</code> 来确定返回的状态码是否在 200-300 范围内，该范围的状态码也表示响应成功。</li>
<li><code>onFailure()</code>：在与服务器通信的时候发生网络异常或者在处理请求或响应的时候发生异常的时候调用。</li>
</ul>
<p>要执行同步请求，你可以使用 <code>execute()</code> 方法。要注意同步请求在主线程会阻塞用户的任何操作。所以不要在主线程执行同步请求，要在后台线程执行。</p>
<h2 id="11-测试应用"><a href="#11-测试应用" class="headerlink" title="11.测试应用"></a>11.测试应用</h2><p>现在你可以运行应用了。</p>
<p><img src="https://cms-assets.tutsplus.com/uploads/users/1499/posts/27792/image/gt5.JPG" alt="Sample results from StackOverflow"></p>
<h2 id="12-结合-RxJava"><a href="#12-结合-RxJava" class="headerlink" title="12. 结合 RxJava"></a>12. 结合 RxJava</h2><p>如果你是 RxJava 的粉丝，你可以通过 RxJava 很简单的实现 Retrofit。RxJava 在 Retrofit 1 中是默认整合的，但是在 Retrofit 2 中需要额外添加依赖。Retrofit 附带了一个默认的 adapter 用于执行 <code>Call</code> 实例，所以你可以通过 RxJava 的 <code>CallAdapter</code> 来改变 Retrofit 的执行流程。</p>
<h3 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a><strong>第一步</strong></h3><p>添加依赖。</p>
<pre><code>compile &apos;io.reactivex:rxjava:1.1.6&apos;
compile &apos;io.reactivex:rxandroid:1.2.1&apos;
compile &apos;com.squareup.retrofit2:adapter-rxjava:2.1.0&apos;
</code></pre><h3 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a><strong>第二步</strong></h3><p>在创建新的 Retrofit 实例的时候添加一个新的 CallAdapter <code>RxJavaCallAdapterFactory.create()</code>。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Retrofit <span class="title">getClient</span><span class="params">(String baseUrl)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (retrofit==<span class="keyword">null</span>) &#123;</span><br><span class="line">        retrofit = <span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">                .baseUrl(baseUrl)</span><br><span class="line">                .addCallAdapterFactory(RxJavaCallAdapterFactory.create())</span><br><span class="line">                .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> retrofit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a><strong>第三步</strong></h3><p>当我们执行请求时，我们的匿名 subscriber 会响应 observable 发射的事件流，在本例中，就是 <code>SOAnswersResponse</code>。当 subscriber 收到任何发射事件的时候，就会调用 <code>onNext()</code> 方法，然后传递到我们的 adapter。<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadAnswers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mService.getAnswers().subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">            .subscribe(<span class="keyword">new</span> Subscriber&lt;SOAnswersResponse&gt;() &#123;</span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(SOAnswersResponse soAnswersResponse)</span> </span>&#123;</span><br><span class="line">                    mAdapter.updateAnswers(soAnswersResponse.getItems());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>查看 Ashraff Hathibelagal 的 <a href="https://code.tutsplus.com/tutorials/getting-started-with-reactivex-on-android--cms-24387" target="_blank" rel="external">Getting Started With ReactiveX on Android</a> 以了解更多关于 RxJava 和 RxAndroid 的内容。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在该教程里，你已经了解了使用 Retrofit 的理由以及方法。我也解释了如何将 RxJava 结合 Retrofit 使用。在我的下一篇文章中，我将为你展示如何执行 <code>POST</code>, <code>PUT</code>, 和 <code>DELETE</code> 请求，如何发送 <code>Form-Urlencoded</code> 数据，以及如何取消请求。</p>
<p>要了解更多关于 Retrofit 的内容，请参考 <a href="https://square.github.io/retrofit/2.x/retrofit/" target="_blank" rel="external">官方文档</a>。同时，请查看我们其他一些关于 Android 应用开发的课程和教程。</p>

    
  </div>
</article>

</div>





  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">Close</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    
  <section class="duoshuo-comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="post-get-started-with-retrofit" 
      data-title="【译】网络请求框架 Retrofit 2 使用入门" data-url="http://yuzhiw.com/2016/12/27/get-started-with-retrofit/index.html"></div>
    <!-- 多说评论框 end -->
  </section>




  <script type="text/javascript">
  var duoshuoQuery = {short_name:"yuzhiw"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>


  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
